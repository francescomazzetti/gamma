<configuration>

	<property scope="system" name="log.mode" value="${SERVICE_LOG_MODE:-produzione}" />

	<statusListener class="ch.qos.logback.core.status.OnConsoleStatusListener"/>

	<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%thread] - %mdc{prefix:-#} - %msg%n%ex</pattern>
		</encoder>
	</appender>
	
	<appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>target/logs/anonymous-users-service.log</file>
		<rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<fileNamePattern>target/logs/anonymous-users-service-%d{yyyy-MM-dd}.log</fileNamePattern>
			<maxHistory>10</maxHistory>
		</rollingPolicy>
		<encoder>
			<pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%.-30thread] - %mdc{prefix:-#} - %msg%n%ex</pattern>
		</encoder>
	</appender>

	<if condition='property("log.mode").equalsIgnoreCase("produzione")'>
	<then>
		<logger name="it.poste.business.anonymous.core.tracer.HttpServletRequestTracerWrapper" level="OFF" />
		<logger name="it.poste.business.anonymous.core.tracer.HttpServletRequestExtractAdapter" level="OFF" />
		<logger name="io.opentracing" level="OFF" />
		<logger name="io.micrometer" level="OFF" />
		<logger name="it.poste.micrometer" level="OFF" />
		<logger name="it.poste.business.anonymous.core.tracer.DataMapExtractAdapter" level="OFF" />
		<logger name="it.poste.business.anonymous.core.tracer.DataMapTracerWrapper" level="OFF" />
		<logger name="it.poste.rest.client.apachehttp" level="OFF" />
		<logger name="org.apache.hc.client5.http" level="OFF" />
		<logger name="it.poste.business.anonymous.core.ldap" level="OFF" />
		<logger name="it.poste.business.anonymous.core.idp.STSExecutor" level="INFO" />
		<logger name="it.poste.notificationgateway.rest.client.jersey2" level="INFO" />
		<logger name="it.poste.business.anonymous" level="INFO" />
		<root level="INFO">
			<appender-ref ref="CONSOLE" />
		</root>
	</then>
	</if>

	<if condition='property("log.mode").equalsIgnoreCase("sviluppo")'>
	<then>
		<logger name="it.poste.business.anonymous.core.tracer.HttpServletRequestTracerWrapper" level="OFF" />
		<logger name="it.poste.business.anonymous.core.tracer.HttpServletRequestExtractAdapter" level="OFF" />
		<logger name="io.opentracing" level="OFF" />
		<logger name="io.micrometer" level="OFF" />
		<logger name="it.poste.micrometer" level="OFF" />
		<logger name="it.poste.business.anonymous.core.tracer.DataMapExtractAdapter" level="OFF" />
		<logger name="it.poste.business.anonymous.core.tracer.DataMapTracerWrapper" level="OFF" />
		<logger name="it.poste.rest.client.apachehttp" level="OFF" />
		<logger name="org.apache.hc.client5.http" level="OFF" />
		<logger name="it.poste.business.anonymous.core.ldap" level="OFF" />
		<logger name="it.poste.business.anonymous.core.idp.STSExecutor" level="INFO" />
		<logger name="it.poste.notificationgateway.rest.client.jersey2" level="INFO" />
		<logger name="it.poste.business.anonymous" level="DEBUG" />
		<root level="DEBUG">
			<appender-ref ref="CONSOLE" />
		</root>
	</then>
	</if>
	
	<if condition='property("log.mode").equalsIgnoreCase("locale")'>
	<then>
		<logger name="it.poste.business.anonymous.core.tracer.HttpServletRequestTracerWrapper" level="OFF" />
		<logger name="it.poste.business.anonymous.core.tracer.HttpServletRequestExtractAdapter" level="OFF" />
		<logger name="io.opentracing" level="OFF" />
		<logger name="io.micrometer" level="OFF" />
		<logger name="it.poste.micrometer" level="OFF" />
		<logger name="it.poste.business.anonymous.core.tracer.DataMapExtractAdapter" level="OFF" />
		<logger name="it.poste.business.anonymous.core.tracer.DataMapTracerWrapper" level="OFF" />
		<logger name="it.poste.rest.client.apachehttp" level="OFF" />
		<logger name="org.apache.hc.client5.http" level="OFF" />
		<logger name="it.poste.business.anonymous.core.ldap" level="OFF" />
		<logger name="it.poste.business.anonymous.core.idp.STSExecutor" level="INFO" />
		<logger name="it.poste.notificationgateway.rest.client.jersey2" level="INFO" />
		<logger name="it.poste.business.anonymous" level="DEBUG" />
		<root level="DEBUG">
			<appender-ref ref="FILE" />
		</root>
	</then>
	</if>

</configuration>
